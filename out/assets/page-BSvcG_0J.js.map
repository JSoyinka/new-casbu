{"version":3,"file":"page-BSvcG_0J.js","sources":["../../src/pages/claim-phone-number/page.tsx"],"sourcesContent":["import { useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { supabase } from '../../lib/supabase';\nimport { useAuth } from '../../contexts/AuthContext';\n\nexport default function ClaimPhoneNumberPage() {\n  const navigate = useNavigate();\n  const { user } = useAuth();\n  const [accessCode, setAccessCode] = useState('');\n  const [currentPhoneNumber, setCurrentPhoneNumber] = useState('');\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState('');\n  const [success, setSuccess] = useState(false);\n  const [claimedPhoneNumber, setClaimedPhoneNumber] = useState('');\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setError('');\n    setLoading(true);\n\n    try {\n      // Check if access code exists and is not taken\n      const { data: claim, error: fetchError } = await supabase\n        .from('phone_number_claims')\n        .select('*')\n        .eq('access_code', accessCode)\n        .maybeSingle();\n\n      if (fetchError) {\n        throw new Error('Error checking access code');\n      }\n\n      if (!claim) {\n        setError('Invalid access code. Please check and try again.');\n        setLoading(false);\n        return;\n      }\n\n      if (claim.taken) {\n        setError('This access code has already been used.');\n        setLoading(false);\n        return;\n      }\n\n      // Verify current phone number matches\n      if (claim.current_phone_number !== currentPhoneNumber) {\n        setError('Current phone number does not match our records.');\n        setLoading(false);\n        return;\n      }\n\n      // Update the claim with user's email and taken date\n      const { error: updateError } = await supabase\n        .from('phone_number_claims')\n        .update({\n          email: user?.email || '',\n          taken: new Date().toISOString()\n        })\n        .eq('id', claim.id);\n\n      if (updateError) {\n        throw new Error('Error claiming phone number');\n      }\n\n      // Success! Show the new phone number\n      setClaimedPhoneNumber(claim.new_phone_number);\n      setSuccess(true);\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'An error occurred');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  if (success) {\n    return (\n      <div className=\"min-h-screen bg-gray-50 dark:bg-gray-900\">\n        {/* Header */}\n        <header className=\"fixed top-0 left-0 right-0 w-full bg-white/80 dark:bg-gray-900/80 backdrop-blur-xl shadow-sm z-[100] border-b border-gray-200/50 dark:border-gray-700/50\">\n          <div className=\"px-4 py-3\">\n            <div className=\"flex items-center justify-between\">\n              <button \n                onClick={() => navigate('/settings')} \n                className=\"w-8 h-8 flex items-center justify-center\"\n              >\n                <i className=\"ri-arrow-left-line text-gray-600 dark:text-gray-400 text-lg\"></i>\n              </button>\n              <div className=\"flex items-center space-x-2\">\n                <div className=\"w-6 h-6 bg-gradient-to-r from-blue-500 via-blue-700 to-purple-600 rounded-lg flex items-center justify-center\">\n                  <i className=\"ri-cpu-line text-white text-sm\"></i>\n                </div>\n                <img \n                  src=\"https://readdy.ai/api/search-image?query=Modern%20technology%20logo%20design%20for%20DirectLine%20app%2C%20sleek%20futuristic%20typography%2C%20connected%20circuit%20lines%20integrated%20into%20letters%2C%20gradient%20blue%20to%20purple%20color%20scheme%2C%20tech%20startup%20aesthetic%2C%20minimalist%20design%2C%20transparent%20background%2C%20high%20contrast%2C%20professional%20branding%2C%20sans-serif%20font%20with%20geometric%20elements%2C%20digital%20communication%20theme&width=300&height=80&seq=directline-logo-main&orientation=landscape\"\n                  alt=\"DirectLine\"\n                  className=\"h-6\"\n                />\n              </div>\n              <div className=\"w-8\"></div>\n            </div>\n          </div>\n        </header>\n\n        {/* Success Content */}\n        <main className=\"pt-20 pb-6 px-4 flex items-center justify-center min-h-screen\">\n          <div className=\"w-full max-w-md\">\n            <div className=\"bg-white dark:bg-gray-800 rounded-2xl p-8 shadow-lg border border-gray-100 dark:border-gray-700 text-center\">\n              <div className=\"w-20 h-20 bg-green-100 dark:bg-green-900/30 rounded-full flex items-center justify-center mx-auto mb-6\">\n                <i className=\"ri-check-line text-green-600 dark:text-green-400 text-4xl\"></i>\n              </div>\n              \n              <h1 className=\"text-2xl font-bold text-gray-900 dark:text-white mb-2\">\n                Phone Number Claimed!\n              </h1>\n              \n              <p className=\"text-gray-600 dark:text-gray-400 mb-6\">\n                Your new phone number has been successfully claimed\n              </p>\n              \n              <div className=\"bg-gradient-to-r from-blue-500 via-blue-700 to-purple-600 rounded-xl p-6 mb-6\">\n                <p className=\"text-sm text-blue-100 mb-2\">Your New Phone Number</p>\n                <p className=\"text-3xl font-bold text-white tracking-wider\">\n                  {claimedPhoneNumber}\n                </p>\n              </div>\n              \n              <p className=\"text-sm text-gray-600 dark:text-gray-400 mb-6\">\n                Save this number for your records. You can now use it to receive calls and messages from your subscribers.\n              </p>\n              \n              <button\n                onClick={() => navigate('/settings')}\n                className=\"w-full bg-gradient-to-r from-blue-500 via-blue-700 to-purple-600 text-white rounded-xl py-3 font-semibold\"\n              >\n                Back to Settings\n              </button>\n            </div>\n          </div>\n        </main>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gray-50 dark:bg-gray-900\">\n      {/* Header */}\n      <header className=\"fixed top-0 left-0 right-0 w-full bg-white/80 dark:bg-gray-900/80 backdrop-blur-xl shadow-sm z-[100] border-b border-gray-200/50 dark:border-gray-700/50\">\n        <div className=\"px-4 py-3\">\n          <div className=\"flex items-center justify-between\">\n            <button \n              onClick={() => navigate('/settings')} \n              className=\"w-8 h-8 flex items-center justify-center\"\n            >\n              <i className=\"ri-arrow-left-line text-gray-600 dark:text-gray-400 text-lg\"></i>\n            </button>\n            <div className=\"flex items-center space-x-2\">\n              <div className=\"w-6 h-6 bg-gradient-to-r from-blue-500 via-blue-700 to-purple-600 rounded-lg flex items-center justify-center\">\n                <i className=\"ri-cpu-line text-white text-sm\"></i>\n              </div>\n              <img \n                src=\"https://readdy.ai/api/search-image?query=Modern%20technology%20logo%20design%20for%20DirectLine%20app%2C%20sleek%20futuristic%20typography%2C%20connected%20circuit%20lines%20integrated%20into%20letters%2C%20gradient%20blue%20to%20purple%20color%20scheme%2C%20tech%20startup%20aesthetic%2C%20minimalist%20design%2C%20transparent%20background%2C%20high%20contrast%2C%20professional%20branding%2C%20sans-serif%20font%20with%20geometric%20elements%2C%20digital%20communication%20theme&width=300&height=80&seq=directline-logo-main&orientation=landscape\"\n                alt=\"DirectLine\"\n                className=\"h-6\"\n              />\n            </div>\n            <div className=\"w-8\"></div>\n          </div>\n        </div>\n      </header>\n\n      {/* Main Content */}\n      <main className=\"pt-20 pb-6 px-4\">\n        <div className=\"max-w-md mx-auto\">\n          {/* Header Section */}\n          <div className=\"text-center mb-8\">\n            <div className=\"w-16 h-16 bg-gradient-to-r from-blue-500 via-blue-700 to-purple-600 rounded-2xl flex items-center justify-center mx-auto mb-4\">\n              <i className=\"ri-phone-line text-white text-2xl\"></i>\n            </div>\n            <h1 className=\"text-2xl font-bold text-gray-900 dark:text-white mb-2\">\n              Claim Your Phone Number\n            </h1>\n            <p className=\"text-gray-600 dark:text-gray-400\">\n              Enter your access code and current phone number to claim your new dedicated number\n            </p>\n          </div>\n\n          {/* Form */}\n          <form onSubmit={handleSubmit} className=\"space-y-6\">\n            <div className=\"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-sm border border-gray-100 dark:border-gray-700\">\n              {/* Access Code Input */}\n              <div className=\"mb-6\">\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                  Access Code\n                </label>\n                <div className=\"relative\">\n                  <div className=\"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 flex items-center justify-center\">\n                    <i className=\"ri-key-line text-gray-400\"></i>\n                  </div>\n                  <input\n                    type=\"text\"\n                    value={accessCode}\n                    onChange={(e) => setAccessCode(e.target.value)}\n                    placeholder=\"Enter your access code\"\n                    className=\"w-full pl-10 pr-4 py-3 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-purple-500\"\n                    required\n                  />\n                </div>\n              </div>\n\n              {/* Current Phone Number Input */}\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                  Current Phone Number\n                </label>\n                <div className=\"relative\">\n                  <div className=\"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 flex items-center justify-center\">\n                    <i className=\"ri-smartphone-line text-gray-400\"></i>\n                  </div>\n                  <input\n                    type=\"tel\"\n                    value={currentPhoneNumber}\n                    onChange={(e) => setCurrentPhoneNumber(e.target.value)}\n                    placeholder=\"Enter your current phone number\"\n                    className=\"w-full pl-10 pr-4 py-3 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-purple-500\"\n                    required\n                  />\n                </div>\n              </div>\n            </div>\n\n            {/* Error Message */}\n            {error && (\n              <div className=\"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4 flex items-start space-x-3\">\n                <i className=\"ri-error-warning-line text-red-600 dark:text-red-400 text-xl flex-shrink-0 mt-0.5\"></i>\n                <p className=\"text-sm text-red-600 dark:text-red-400\">{error}</p>\n              </div>\n            )}\n\n            {/* Submit Button */}\n            <button\n              type=\"submit\"\n              disabled={loading}\n              className=\"w-full bg-gradient-to-r from-blue-500 via-blue-700 to-purple-600 text-white rounded-xl py-4 font-semibold shadow-lg disabled:opacity-50 disabled:cursor-not-allowed\"\n            >\n              {loading ? (\n                <span className=\"flex items-center justify-center space-x-2\">\n                  <i className=\"ri-loader-4-line animate-spin\"></i>\n                  <span>Verifying...</span>\n                </span>\n              ) : (\n                'Claim Phone Number'\n              )}\n            </button>\n          </form>\n\n          {/* Info Box */}\n          <div className=\"mt-6 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4\">\n            <div className=\"flex items-start space-x-3\">\n              <i className=\"ri-information-line text-blue-600 dark:text-blue-400 text-xl flex-shrink-0 mt-0.5\"></i>\n              <div>\n                <h3 className=\"font-medium text-blue-900 dark:text-blue-300 mb-1\">\n                  How it works\n                </h3>\n                <p className=\"text-sm text-blue-600 dark:text-blue-400\">\n                  Enter the access code you received and your current phone number. If they match our records and the code hasn't been used, you'll receive your new dedicated phone number.\n                </p>\n              </div>\n            </div>\n          </div>\n        </div>\n      </main>\n    </div>\n  );\n}\n"],"names":["ClaimPhoneNumberPage","navigate","useNavigate","user","useAuth","accessCode","setAccessCode","useState","currentPhoneNumber","setCurrentPhoneNumber","loading","setLoading","error","setError","success","setSuccess","claimedPhoneNumber","setClaimedPhoneNumber","handleSubmit","e","claim","fetchError","supabase","updateError","err","jsxs","jsx"],"mappings":"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"}